<div
  class="container mx-auto"
  [ngClass]="{
    'text-gray-900': !(isDarkTheme$ | async),
    'text-white': (isDarkTheme$ | async)
  }"
>
  <div class="mt-10">
    <div class="user-pdf-controls-container">
      <button
        [ngClass]="{
          'text-gray-900': !(isDarkTheme$ | async),
          'text-white': (isDarkTheme$ | async)
        }"
        (click)="uploadInput.click()"
        class="py-2 px-1 text-sm hover:bg-blue-700 hover:text-white rounded-md"
      >
        Upload PDF
      </button>
      <label class="text-center inline-flex justify-center items-center">
        <span class="mr-3">PDF Encoding:</span>
        <div class="relative">
          <select
            [(ngModel)]="selectedEncoding"
            class="block appearance-none w-full bg-white border border-gray-300 text-black py-2 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-blue-500"
          >
            <option value="gpt2">gpt2</option>
            <option value="p50k_base">p50k_base</option>
            <option value="cl100k_base">cl100k_base</option>
          </select>
          <div
            class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"
          >
            <svg
              class="fill-current h-4 w-4"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
            >
              <path
                d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"
              />
            </svg>
          </div>
        </div>
      </label>
      <button
        [ngClass]="{
          'text-gray-900': !(isDarkTheme$ | async),
          'text-white': (isDarkTheme$ | async)
        }"
        (click)="resetMetrics()"
        class="py-2 px-1 text-sm hover:bg-blue-700 hover:text-white rounded-md"
      >
        Reset PDF
      </button>
      <div hidden>
        <input
          #uploadInput
          type="file"
          class="mt-1 block w-full py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-black"
          (change)="onFileSelect($event)"
          accept="application/pdf"
        />
      </div>
    </div>

    <div *ngIf="!file && !loading" class="text-center mt-10">
      <h1
        [ngClass]="{
          'text-gray-900': !(isDarkTheme$ | async),
          'text-white': (isDarkTheme$ | async)
        }"
        class="sm:text-3xl text-2xl font-medium title-font mb-2"
      >
        Please upload a PDF file to view its metrics.
      </h1>
    </div>

    <div
      *ngIf="metrics"
      class="p-6 m-4"
      [ngClass]="{
        'text-gray-900': !(isDarkTheme$ | async),
        'text-white': (isDarkTheme$ | async)
      }"
    >
      <section class="body-font">
        <div class="container px-5 mx-auto">
          <div class="flex flex-wrap -m-4">
            <ng-container *ngFor="let item of metricEntries">
              <div class="p-4 md:w-1/3" *ngIf="item.value">
                <div class="flex rounded-lg h-full p-8 flex-col">
                  <div class="flex items-center justify-center mb-3">
                    <div
                      class="w-8 h-8 mr-3 inline-flex items-center justify-center rounded-full bg-blue-500 flex-shrink-0"
                    >
                      <svg
                        fill="none"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        class="w-5 h-5"
                        viewBox="0 0 24 24"
                      >
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                      </svg>
                    </div>
                    <h2 class="text-lg title-font font-medium">
                      {{ item.key }}
                    </h2>
                  </div>
                  <div class="flex-grow justify-center text-center">
                    <p
                      class="leading-relaxed text-base"
                      *ngIf="item.key !== 'Cost'"
                    >
                      {{ item.value }}
                    </p>
                    <p
                      class="leading-relaxed text-base"
                      *ngIf="item.key === 'Cost'"
                    >
                      {{ item.value | currency }}
                    </p>
                    <p class="mt-2 text-sm italic">{{ item.explanation }}</p>
                  </div>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </section>
    </div>
    <div *ngIf="loading" class="mx-4 my-4">
      <p>Loading PDF...</p>
      <div class="mx-4 md:mx-10 h-3 relative rounded-full overflow-hidden">
        <div class="w-full h-full bg-gray-200 absolute"></div>
        <div
          #progressBar
          class="transition-all ease-out duration-1000 h-full bg-blue-500 relative w-0"
        ></div>
      </div>
    </div>
  </div>
</div>
